{"version":3,"sources":["scripts/app.js"],"names":["angular","module","navbar","NavbarController","$http","search","query","length","url","get","then","res","vm","searchRes","data","parseSearch","obj","isObject","show","externals","imdb","name","this","searchText","$inject","component","templateUrl","controller","controllerAs","ShowController","$stateParams","$httpParamSerializer","lodash","$window","$rootScope","space","toJson","setEpisode","ep","selectedEpisode","el","document","querySelector","element","scrollLeft","innerWidth","scrollBack","loadSubtitles","episode","langs","api","imdbid","id","season","subtitles","activate","episodes","getEpisodes","selectedSeason","eps","grouped","_","groupBy","moreGrouped","Object","keys","map","index","sortedSeason","sortBy","number","selectedLang","MainController","toastr","showData","error","err","showToastr","info","creationDate","showlist","runBlock","$log","debug","run","routerConfig","$stateProvider","$urlRouterProvider","state","otherwise","config","constant","moment","$logProvider","toastrConfig","debugEnabled","allowHtml","timeOut","positionClass","preventDuplicates","progressBar","$templateCache","put"],"mappings":"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","file":"scripts/app-9a1a41521c.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular\n    .module('palomitasClient2', [\n      'ui.router', \n      'ui.bootstrap', \n      'toastr', \n      'ngLodash',\n      'duScroll'\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('palomitasClient2')\n    .component('navbar', navbar());\n\n  /** @ngInject */\n  function navbar() {\n    var component = {\n      templateUrl: 'app/components/navbar/navbar.html',\n      controller: NavbarController,\n      controllerAs: 'vm'\n    };\n\n    return component;\n\n    /** @ngInject */\n    function NavbarController($http) {\n      var vm = this;\n      vm.searchRes;\n      vm.searchText = \"\";\n      vm.search = search;\n      vm.parseSearch = parseSearch;\n      \n      function search(query){\n        if(!query || query.length < 2){\n          return;\n        }\n        var url = \"https://tvapi.fuken.xyz\"\n        url += \"/search?query=\"+query;\n        return $http.get(url).then(function(res){\n          vm.searchRes = res.data;\n          return res.data;\n        })\n      }\n      \n      function parseSearch(obj){\n        if(!angular.isObject(obj) ||\n           !obj.show || \n           !obj.show.externals || \n           !obj.show.externals.imdb){\n          return null;\n        }\n        return /*obj.show.externals.imdb+\": \"+*/ obj.show.name;\n      }\n      \n    }\n  }\n\n})();\n\n(function(){\n  'use strict';\n  \n  angular\n    .module('palomitasClient2')\n    .controller('ShowController', ShowController);\n    \n  /** @ngInject */\n  function ShowController($stateParams, $http, $httpParamSerializer, lodash, $window, $rootScope){\n    var vm = this;\n    var _  = lodash;\n    \n    vm.id = $stateParams.id;\n    vm.show     = {};\n    vm.episodes = [];\n    vm.langs    = [];\n    vm.selectedSeason  = [];\n    vm.selectedEpisode = {};\n    vm.selectedLang    = \"\";\n\n    vm.space = space;\n    vm.setEpisode = setEpisode;    \n    vm.scrollBack = scrollBack;\n    vm.loadSubtitles = loadSubtitles;\n\n    activate();\n    \n    // PUBLIC METHODS\n    \n    function space(obj){\n      return angular.toJson(obj, true);\n    }\n    \n    function setEpisode(ep){\n      vm.selectedEpisode = ep;\n      var el = document.querySelector(\".episodes\");\n      angular.element(el).scrollLeft($window.innerWidth, 400);\n    }\n    \n    function scrollBack(){\n      var el = document.querySelector(\".episodes\");\n      angular.element(el).scrollLeft(0, 400);\n    }\n    \n    function loadSubtitles(episode){\n      vm.langs = $rootScope.langs;\n      var api = \"https://sub-down.fuken.xyz\";\n      var url = api+\"/search?\"+$httpParamSerializer({\n        imdbid: vm.id,\n        season: episode.season,\n        episode: episode.episode\n      });\n\n      $http.get(url).then(function onSubtitles(res) {\n        vm.subtitles = res.data;\n      })\n    }\n\n    // PRIVATE METHODS\n    \n    function activate(){\n      var api = \"https://api-fetch.website/tv/\";\n      var url = api+\"/show/\"+vm.id;\n      $http.get(url).then(function(res){\n        vm.show = res.data;\n        vm.episodes = getEpisodes(res.data);\n        vm.selectedSeason = vm.episodes[0].episodes;\n        vm.selectedEpisode = vm.selectedSeason[0];\n      });\n    }\n    \n    function getEpisodes(show){\n      var eps = show.episodes;\n      var grouped = _.groupBy(eps, 'season');\n      var moreGrouped = Object.keys(grouped).map(function(index){\n        var season = grouped[index];\n        var sortedSeason = _.sortBy(season, 'episode');\n        return { number: sortedSeason[0].season, episodes: sortedSeason };\n      });\n      return moreGrouped;\n    }\n    \n    \n    \n  }\n  \n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('palomitasClient2')\n    .controller('MainController', MainController);\n\n  /** @ngInject */\n  function MainController(toastr, $http) {\n    var vm = this;\n    var api = \"https://tvapi.fuken.xyz\"\n\n    vm.creationDate = 1463518051145;\n    vm.showData = null;\n    vm.error = null;\n\n    vm.showToastr = showToastr;\n    vm.showlist = function(){};\n\n    activate();\n\n    function activate(){\n      $http.get(api+\"/shows\")\n        .then(function(res){\n          vm.showData = res.data;\n          vm.error = null;\n        })\n        .catch(function(err){\n          vm.error = err;\n        });\n    }\n\n    function showToastr() {\n      toastr.info('Fork <a href=\"https://github.com/Swiip/generator-gulp-angular\" target=\"_blank\"><b>generator-gulp-angular</b></a>');\n    }\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('palomitasClient2')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock($log, $http, $rootScope) {\n    $log.debug('Palomitas V2');\n    var api = \"https://sub-down.fuken.xyz\";\n    var url = api+\"/weblangs.json\";\n    $http.get(url).then(function(res){\n      $rootScope.langs = res.data;\n    });\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('palomitasClient2')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('home', {\n        url: '/',\n        templateUrl: 'app/main/main.html',\n        controller: 'MainController',\n        controllerAs: 'vm'\n      })\n      .state('show_detail', {\n        url:'/show/:id',\n        templateUrl: 'app/show/show.detail.html',\n        controller: 'ShowController',\n        controllerAs: 'vm'\n      });\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n/* global moment:false */\n(function() {\n  'use strict';\n\n  angular\n    .module('palomitasClient2')\n    .constant('moment', moment);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('palomitasClient2')\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider, toastrConfig) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n\n    // Set options third-party lib\n    toastrConfig.allowHtml = true;\n    toastrConfig.timeOut = 3000;\n    toastrConfig.positionClass = 'toast-top-right';\n    toastrConfig.preventDuplicates = true;\n    toastrConfig.progressBar = true;\n  }\n\n})();\n\nangular.module(\"palomitasClient2\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/main/main.html\",\"<main style=\\\"padding: 1.2em\\\"><h1 class=\\\"text-center header-shadow\\\">Proyecto Palomitas</h1><h2 class=text-center>El poder de la red P2P en tu navegador</h2><div class=row><h3 class=\\\"col-sm-3 col-xs-6 p1em text-center\\\"><span class=\\\"header-icon glyphicon glyphicon-fire\\\"></span><br><span>Las útlimas novedades</span></h3><h3 class=\\\"col-sm-3 col-xs-6 p1em text-center\\\"><span class=\\\"header-icon glyphicon glyphicon-film\\\"></span><br><span>Todas las series en version original</span></h3><h3 class=\\\"col-sm-3 col-xs-6 p1em text-center\\\"><span class=\\\"header-icon glyphicon glyphicon-globe\\\"></span><br><span>Subtitulos en todos los idiomas</span></h3><h3 class=\\\"col-sm-3 col-xs-6 p1em text-center\\\"><span class=\\\"header-icon glyphicon glyphicon-cloud\\\"></span><br>Proyecto de codigo abierto. Haz <a href=http://github.com/juandjara/palomitas-angular>tus propias palomitas</a></h3></div><!-- Solo se muestra mientras se realiza la peticion inicial --><h1 style=\\\"color: lightgrey\\\" ng-hide=vm.showData>Loading...</h1><!-- Solo se muestra si la peticion inicial tuvo exito --><div class=row ng-show=vm.showData><h1 class=\\\"col-sm-12 header-shadow\\\">Las series más populares:</h1><div class=\\\"col-sm-12 shows\\\" ng-show=vm.showData><div class=show-card ng-repeat=\\\"show in vm.showData |limitTo: 15\\\"><div class=show-img><img ng-src={{show.image.medium}} alt={{show.name}}></div><div class=overlay><div class=\\\"ribbon opensans\\\"><p>{{show.name}}</p><p class=badge style=\\\"font-size: smaller\\\">{{show.rating.average}} / 10</p><a ng-href=#/show/{{show.externals.imdb}} class=\\\"no-br btn btn-lg btn-success\\\">Detalles</a></div></div></div></div></div><!-- Solo se muestra si la peticion inicial falló --><div style=\\\"text-align: left\\\" ng-show=vm.error><p>Error</p><pre>\\n      {{vm.error | json}}\\n    </pre></div></main>\");\n$templateCache.put(\"app/show/show.detail.html\",\"<div class=show-details><div class=show-img><img ng-src={{vm.show.images.banner}} alt={{vm.show.title}}></div><div class=overlay><img class=\\\"poster hidden-xs\\\" ng-src={{vm.show.images.poster}} alt={{vm.show.title}}><header class=header><h1>{{vm.show.title}} <span class=badge>{{vm.show.rating.percentage / 10}} / 10</span></h1><h4><p>{{vm.show.year}} - {{vm.show.status}}</p><span ng-repeat=\\\"genre in vm.show.genres\\\">{{genre}} <span ng-hide=$last>,</span></span></h4><p style=\\\"font-weight: bolder\\\" class=opensans>{{vm.show.synopsis}}</p></header></div></div><div class=opensans style=\\\"margin-top: 1em; padding: 0 1em\\\"><h1 style=\\\"margin-top: 0; margin-bottom: .5em\\\">Episodios</h1><div class=episodes><div class=episode-selector><div class=\\\"season-list btn-group-vertical\\\"><button class=\\\"btn btn-primary\\\" ng-repeat=\\\"season in vm.episodes\\\" ng-click=\\\"vm.selectedSeason = season.episodes\\\">Temporada {{season.number}}</button></div><ul class=\\\"episode-list list-group\\\" style=\\\"margin-left: 1em\\\"><li class=list-group-item style=\\\"color: black\\\" ng-repeat=\\\"ep in vm.selectedSeason\\\"><a href ng-click=vm.setEpisode(ep)>{{ep.season}}x{{ep.episode}} - {{ep.title}}</a></li></ul></div><div class=episode><button class=\\\"visible-xs btn btn-primary\\\" style=\\\"margin-top: 1em\\\" ng-click=vm.scrollBack()><span class=\\\"glyphicon glyphicon-chevron-left\\\"></span> Atrás</button><h2 style=\\\"margin-top: 0.2em\\\">{{vm.selectedEpisode.title}}</h2><p style=\\\"color: grey\\\">Season {{vm.selectedEpisode.season}} Episode {{vm.selectedEpisode.episode}}</p><p>{{vm.selectedEpisode.overview}}</p><br><uib-tabset><uib-tab ng-repeat=\\\"(type, torrent) in vm.selectedEpisode.torrents\\\" index=$index heading={{type}} ng-if=\\\"type != 0\\\"><div class=tab-inner><p>seeds: {{torrent.seeds}} | peers: {{torrent.peers}}</p><pre class=pre-wrap>{{torrent.url}}</pre></div></uib-tab></uib-tabset><p><br>Puede usar este <em>magnet link</em> para ver el episodio usando <a href=https://peerflix-server.herokuapp.com>Peerflix server</a><br>Pegue alli el <em>magnet link</em> y podra ver el progreso del torrent<br>Pasados unos segundos podra ver el progreso de la descarga del torrent y una lista de enlaces a los archivos que contiene este torrent.<br>Podra usar el enlace del archivo de video para ver el episodio en un reproductor como <em>VLC</em> o <em>MPV</em></p><button class=\\\"btn btn-primary\\\" ng-click=vm.loadSubtitles(vm.selectedEpisode)><span class=\\\"glyphicon glyphicon-globe\\\"></span> Buscar subtitulos</button><div class=form-group ng-show=vm.subtitles style=\\\"margin-top: 1em; display: flex; align-items: center\\\"><label for=langs style=\\\"margin-right: 0.5em\\\">Idioma</label><select ng-model=vm.selectedLang class=form-control name=langs id=langs><option ng-value=lang.isoId ng-repeat=\\\"lang in vm.langs\\\">{{lang.name}}</option></select></div><ul class=\\\"list-group subs-list\\\" ng-show=vm.selectedLang style=\\\"color: black\\\"><li class=list-group-item ng-repeat=\\\"sub in vm.subtitles[vm.selectedLang]\\\" style=\\\"display: flex; align-items: center\\\"><div style=\\\"flex: 0 1 65%\\\"><a class=pre-wrap ng-href={{sub.url}}>{{sub.subFilename}}</a></div><div style=\\\"flex: 1 0 35%; margin-left: 1em\\\"><p><span title=Formato class=\\\"glyphicon glyphicon-file\\\"></span> {{sub.encoding}}</p><p><span title=Descargas class=\\\"glyphicon glyphicon-download\\\"></span> {{sub.downloads.toLocaleString()}}</p><p><span title=\\\"Fecha de subida\\\" class=\\\"glyphicon glyphicon-calendar\\\"></span> {{sub.date.toLocaleString()}}</p></div></li></ul></div></div></div>\");\n$templateCache.put(\"app/components/navbar/navbar.html\",\"<nav class=nav-bar><a href=# class=nav-logo><img class=nav-icon alt=\\\"Logo de Palomitas\\\" src=assets/images/popcorn-icon.png> <span>Palomitas</span></a><section class=nav-search><input type=text placeholder=\\\"¿Que quieres ver?\\\" class=transparent ng-model=vm.searchText ng-model-options=\\\"{debounce: 300}\\\" typeahead-no-results=\\\"\\'No results\\'\\\" uib-typeahead=\\\"option as vm.parseSearch(option) for option in vm.search($viewValue)\\\" typeahead-template-url=app/components/navbar/searchItem.html typeahead-popup-template-url=app/components/navbar/searchPopup.html> <span class=\\\"glyphicon glyphicon-search inside-input\\\"></span></section></nav>\");\n$templateCache.put(\"app/components/navbar/searchItem.html\",\"<div ng-attr-title={{match.label}} class=search-item ng-cloak><img class=search-img ng-src={{match.model.show.image.medium}}> <a ng-href=#/show/{{match.model.show.externals.imdb}} class=search-label>{{match.model.show.name}}</a></div>\");\n$templateCache.put(\"app/components/navbar/searchPopup.html\",\"<ul class=\\\"list-unstyled search-results\\\" ng-show=\\\"isOpen() && !moveInProgress\\\" ng-style=\\\"{top: position().top+\\'px\\',\\n               left: position().left+\\'px\\'}\\\" role=listbox aria-hidden={{!isOpen()}}><li ng-repeat=\\\"match in matches track by $index\\\" ng-class=\\\"{active: isActive($index) }\\\" ng-mouseenter=selectActive($index) ng-click=\\\"selectMatch($index, $event)\\\" role=option id={{::match.id}}><div uib-typeahead-match index=$index match=match query=query template-url=templateUrl></div></li></ul>\");}]);"],"sourceRoot":"/source/"}